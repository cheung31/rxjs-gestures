{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import 'rxjs/add/operator/let';\nimport 'rxjs/add/operator/take';\nimport 'rxjs/add/operator/mapTo';\nimport 'rxjs/add/operator/filter';\nimport 'rxjs/add/observable/empty';\nimport 'rxjs/add/observable/never';\nimport 'rxjs/add/observable/timer';\nimport 'rxjs/add/operator/mergeMap';\nimport 'rxjs/add/operator/multicast';\nimport 'rxjs/add/operator/startWith';\nimport 'rxjs/add/operator/takeUntil';\nimport 'rxjs/add/operator/takeWhile';\nimport 'rxjs/add/operator/timeoutWith';\nimport 'rxjs/add/observable/fromEvent';\nimport 'rxjs/add/operator/timeInterval';\nimport 'rxjs/add/operator/withLatestFrom';\n\nimport { Subject } from 'rxjs/Subject';\nimport { Observable } from 'rxjs/Observable';\nimport $$observable from 'symbol-observable';\nimport { async } from 'rxjs/scheduler/async';\nimport { epsilon, selectId, normalize } from './support';\nimport { TapOperator, PanOperator,\n         DeltaOperator, PressOperator,\n         DecelerateOperator, PreventDefaultOperator,\n         StopPropagationOperator } from './operators';\n\nconst mouseEvents = {\n    start: 'mousedown', end: 'mouseup',\n    move: 'mousemove', cancel: 'mouseleave',\n    wheel: 'wheel',\n};\n\nconst touchEvents = {\n    start: 'touchstart', end: 'touchend',\n    move: 'touchmove', cancel: 'touchcancel'\n};\n\nexport function install(topLevelElement = getTopLevelElement()) {\n    return class InstalledGestures extends Gestures {\n        static topLevelElement = topLevelElement;\n    }\n}\n\nexport class Gestures extends Observable {\n    static topLevelElement = getTopLevelElement();\n    constructor(target, ...events) {\n        if (!target || typeof target === 'function' || typeof target !== 'object') {\n            super(target);\n        } else if (typeof target[$$observable] === 'function') {\n            super();\n            this.source = target[$$observable]();\n        } else if (events.length === 1) {\n            super();\n            this.source = Observable.fromEvent(target, event[0]);\n        } else {\n            super();\n            this.source = Observable.merge(...events.map((event) =>\n                Observable.fromEvent(target, event)\n            ));\n        }\n    }\n    static from(...args) {\n        return new Gestures(...args);\n    }\n    lift(operator) {\n        const observable = new this.constructor(this);\n        observable.operator = operator;\n        return observable;\n    }\n    preventDefault() {\n        return this.lift(new PreventDefaultOperator());\n    }\n    stopPropagation(immediate = false) {\n        return this.lift(new StopPropagationOperator(immediate));\n    }\n    delta(point, scheduler = async) {\n        return this.lift(new DeltaOperator(point, scheduler));\n    }\n    decelerate(coefficientOfFriction = 0.25, normalForce = 9.8, scheduler = async) {\n        return this.lift(new DecelerateOperator(coefficientOfFriction, normalForce, scheduler));\n    }\n    inside({ x: radiusX, y: radiusY }, point) {\n        return this.delta(point).filter(({ totalX, totalY }) => !epsilon(\n            radiusX, radiusY, totalX, totalY\n        ));\n    }\n    outside({ x: radiusX, y: radiusY }, point) {\n        return this.delta(point).filter(({ totalX, totalY }) => epsilon(\n            radiusX, radiusY, totalX, totalY\n        ));\n    }\n    static startsById(target = this.topLevelElement) {\n        const { topLevelElement } = this;\n        return this\n            .start(target)\n            .multicast(() => new Subject(), (starts) => Observable.merge(\n                starts.take(1),\n                starts.takeWhile(({ identifier }) => (\n                    identifier !== 'mouse'\n                ))\n            ))\n            .let(Gestures.from)\n            .groupBy(getIdentifier, null, (starts) => this\n                .race(this.end(topLevelElement), this.cancel(topLevelElement))\n                .filter(selectId(starts.key))\n            );\n    }\n    static start(target = this.topLevelElement) {\n        return new this(target, mouseEvents.start, touchEvents.start).mergeMap(normalize);\n    }\n    static move(target = this.topLevelElement) {\n        return new this(target, mouseEvents.move, touchEvents.move).mergeMap(normalize);\n    }\n    static end(target = this.topLevelElement) {\n        return new this(target, mouseEvents.end, touchEvents.end).mergeMap(normalize);\n    }\n    static cancel(target = this.topLevelElement) {\n        return new this(target, mouseEvents.cancel, touchEvents.cancel).mergeMap(normalize);\n    }\n    static tap(target = this.topLevelElement, timeout = 250, radius = { x: 10, y: 10 }, ends, cancels) {\n        if (arguments.length <= 3) {\n            return this.startsById(target).lift(new TapOperator(timeout, radius, this));\n        }\n        return new this(target).preventDefault().mergeMap((start) => ends\n            .inside(radius, start)\n            .map((end) => ({ ...end, type: start.type }))\n            .timeoutWith(timeout, Observable.empty())\n        )\n        .takeUntil(cancels)\n        .take(1);\n    }\n    static pan(target = this.topLevelElement, delay = 0, radius = { x: 10, y: 10 }, moves, ends, cancels) {\n        if (arguments.length <= 3) {\n            return this.startsById(target).lift(new PanOperator(delay, radius, this));\n        }\n        return new this(target)\n            .preventDefault()\n            .mergeMap((start) => moves.delta(start).startWith(start))\n            .takeUntil(ends.merge(cancels));\n    }\n    static press(target = this.topLevelElement, delay = 0, radius = { x: 10, y: 10 }, moves, ends, cancels) {\n        if (arguments.length <= 3) {\n            return this.startsById(target).lift(new PressOperator(delay, radius, this));\n        }\n        return (delay <= 0 ? target : new this(target)\n            .preventDefault().mergeMap((start) => Observable\n                .timer(delay)\n                .withLatestFrom(moves.startWith(start), (i, move) => ({\n                    ...move, type: start.type\n                }))\n                .takeUntil(ends\n                    .merge(cancels)\n                    .merge(moves.outside(radius, start)))\n            )\n        )\n        .take(1);\n    }\n}\n\nfunction identity(x){ return x; }\nfunction getIdentifier({ identifier }){ return identifier; }\nfunction getTopLevelElement() {\n    return typeof window !== 'undefined' ?\n        window : typeof document !== 'undefined' ?\n            document : global;\n}\n\nexport { Gestures as default };\n"]}